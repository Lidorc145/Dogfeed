{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"children\"],\n  _excluded2 = [\"manageFocus\", \"defaultValue\", \"value\", \"space\", \"onChange\"];\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nimport React from 'react';\nimport { HStack } from \"../../primitives/Stack\";\nimport { useThemeProps } from \"../../../hooks\";\nimport { useFormControlContext } from \"../FormControl\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport { PinInputContext } from \"./Context\";\nimport { themeTools } from \"../../../theme\";\nimport { useHasResponsiveProps } from \"../../../hooks/useHasResponsiveProps\";\nvar PinInput = function PinInput(_ref, ref) {\n  var children = _ref.children,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var _themeTools$extractIn = themeTools.extractInObject(props, ['p', 'px', 'py', 'pt', 'pb', 'pl', 'pr']),\n    _themeTools$extractIn2 = _slicedToArray(_themeTools$extractIn, 2),\n    padding = _themeTools$extractIn2[0],\n    remProps = _themeTools$extractIn2[1];\n  var _useThemeProps = useThemeProps('PinInput', remProps),\n    manageFocus = _useThemeProps.manageFocus,\n    defaultValue = _useThemeProps.defaultValue,\n    value = _useThemeProps.value,\n    space = _useThemeProps.space,\n    onChange = _useThemeProps.onChange,\n    newProps = _objectWithoutProperties(_useThemeProps, _excluded2);\n  var formControlContext = useFormControlContext();\n  var RefList = [];\n  var setRefList = function setRefList(ref, index) {\n    RefList[index] = ref;\n  };\n  var _React$useState = React.useState(value || defaultValue),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    pinInputValue = _React$useState2[0],\n    setPinInputValue = _React$useState2[1];\n  var handleChange = function handleChange(newValue, fieldIndex) {\n    var temp = pinInputValue && _toConsumableArray(pinInputValue) || [];\n    temp[fieldIndex] = newValue;\n    value === undefined && setPinInputValue(temp.join(''));\n    onChange && onChange(temp.join(''));\n    if (newValue === '' && manageFocus && fieldIndex - 1 > -1) RefList[fieldIndex - 1].current.focus();else if (newValue && manageFocus && fieldIndex + 1 < RefList.length) RefList[fieldIndex + 1].current.focus();\n    return temp.join('');\n  };\n  var handleMultiValueChange = function handleMultiValueChange(newValue, fieldIndex) {\n    var pinFieldLength = RefList.length;\n    var newValueLength = newValue.length;\n    if (newValueLength >= pinFieldLength && newValueLength > 2) {\n      var splicedValue = newValue ? _toConsumableArray(newValue) : [];\n      splicedValue.splice(pinFieldLength);\n      RefList[pinFieldLength - 1].current.focus();\n      setPinInputValue(splicedValue.join(''));\n      onChange && onChange(splicedValue.join(''));\n    }\n    if (Platform.OS !== 'ios') {\n      var temp = pinInputValue ? _toConsumableArray(pinInputValue) : [];\n      if (newValue === '') {\n        temp = temp.filter(function (_n, i) {\n          return i !== fieldIndex;\n        });\n        if (manageFocus && fieldIndex - 1 > -1) RefList[fieldIndex - 1].current.focus();\n      } else {\n        temp[fieldIndex] = JSON.stringify(parseInt(newValue, 10) % 10);\n        if (manageFocus && fieldIndex + 1 < RefList.length) RefList[fieldIndex + 1].current.focus();\n      }\n      value === undefined && setPinInputValue(temp.join(''));\n      onChange && onChange(temp.join(''));\n    }\n  };\n  var indexSetter = function indexSetter(allChildren) {\n    var pinInputFiledCounter = -1;\n    return React.Children.map(allChildren, function (child) {\n      pinInputFiledCounter++;\n      return React.cloneElement(child, {\n        fieldIndex: pinInputFiledCounter\n      }, child.props.children);\n    });\n  };\n  React.useEffect(function () {\n    if (value !== undefined && value != pinInputValue) setPinInputValue(value);\n  }, [value, pinInputValue, setPinInputValue]);\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n  return React.createElement(PinInputContext.Provider, {\n    value: _objectSpread(_objectSpread(_objectSpread({}, formControlContext), newProps), {}, {\n      setRefList: setRefList,\n      handleChange: handleChange,\n      handleMultiValueChange: handleMultiValueChange,\n      value: pinInputValue\n    })\n  }, children && React.createElement(HStack, _extends({\n    flexDirection: \"row\",\n    space: space\n  }, padding, {\n    ref: ref\n  }), indexSetter(children)));\n};\nexport default React.memo(React.forwardRef(PinInput));","map":{"version":3,"mappings":"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","names":["React","HStack","useThemeProps","useFormControlContext","PinInputContext","themeTools","useHasResponsiveProps","PinInput","ref","children","props","extractInObject","padding","remProps","manageFocus","defaultValue","value","space","onChange","newProps","formControlContext","RefList","setRefList","index","useState","pinInputValue","setPinInputValue","handleChange","newValue","fieldIndex","temp","undefined","join","current","focus","length","handleMultiValueChange","pinFieldLength","newValueLength","splicedValue","splice","Platform","OS","filter","_n","i","JSON","stringify","parseInt","indexSetter","allChildren","pinInputFiledCounter","Children","map","child","cloneElement","useEffect","Provider","flexDirection","memo","forwardRef"],"sources":["PinInput.tsx"],"sourcesContent":["import React from 'react';\nimport { HStack } from '../../primitives/Stack';\nimport { useThemeProps } from '../../../hooks';\nimport type { IPinInputProps } from './types';\nimport { useFormControlContext } from '../FormControl';\nimport { Platform } from 'react-native';\nimport { PinInputContext } from './Context';\nimport { themeTools } from '../../../theme';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\n\nconst PinInput = ({ children, ...props }: IPinInputProps, ref?: any) => {\n  let [padding, remProps] = themeTools.extractInObject(props, [\n    'p',\n    'px',\n    'py',\n    'pt',\n    'pb',\n    'pl',\n    'pr',\n  ]);\n  const {\n    manageFocus,\n    defaultValue,\n    value,\n    space,\n    onChange,\n    ...newProps\n  } = useThemeProps('PinInput', remProps);\n  const formControlContext = useFormControlContext();\n\n  const RefList: Array<any> = [];\n  const setRefList = (ref: any, index: number) => {\n    RefList[index] = ref;\n  };\n  const [pinInputValue, setPinInputValue] = React.useState(\n    value || defaultValue\n  );\n\n  const handleChange = (newValue: string, fieldIndex: number) => {\n    let temp = (pinInputValue && [...pinInputValue]) || [];\n    temp[fieldIndex] = newValue;\n    value === undefined && setPinInputValue(temp.join(''));\n    onChange && onChange(temp.join(''));\n    if (newValue === '' && manageFocus && fieldIndex - 1 > -1)\n      RefList[fieldIndex - 1].current.focus();\n    else if (newValue && manageFocus && fieldIndex + 1 < RefList.length)\n      RefList[fieldIndex + 1].current.focus();\n    return temp.join('');\n  };\n  const handleMultiValueChange = (newValue: string, fieldIndex: number) => {\n    const pinFieldLength = RefList.length;\n    const newValueLength = newValue.length;\n    if (newValueLength >= pinFieldLength && newValueLength > 2) {\n      let splicedValue = newValue ? [...newValue] : [];\n      splicedValue.splice(pinFieldLength);\n      RefList[pinFieldLength - 1].current.focus();\n      setPinInputValue(splicedValue.join(''));\n      onChange && onChange(splicedValue.join(''));\n    }\n\n    if (Platform.OS !== 'ios') {\n      let temp = pinInputValue ? [...pinInputValue] : [];\n      if (newValue === '') {\n        // Handling Backward focus.\n        temp = temp.filter((_n, i) => i !== fieldIndex);\n        if (manageFocus && fieldIndex - 1 > -1)\n          RefList[fieldIndex - 1].current.focus();\n      } else {\n        temp[fieldIndex] = JSON.stringify(parseInt(newValue, 10) % 10);\n        if (manageFocus && fieldIndex + 1 < RefList.length)\n          RefList[fieldIndex + 1].current.focus();\n      }\n      value === undefined && setPinInputValue(temp.join(''));\n      onChange && onChange(temp.join(''));\n    }\n  };\n\n  const indexSetter = (allChildren: JSX.Element | JSX.Element[]) => {\n    let pinInputFiledCounter = -1;\n    return React.Children.map(allChildren, (child: JSX.Element) => {\n      pinInputFiledCounter++;\n      return React.cloneElement(\n        child,\n        {\n          fieldIndex: pinInputFiledCounter,\n        },\n        child.props.children\n      );\n    });\n  };\n\n  React.useEffect(() => {\n    if (value !== undefined && value != pinInputValue) setPinInputValue(value);\n  }, [value, pinInputValue, setPinInputValue]);\n\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n\n  return (\n    <PinInputContext.Provider\n      value={{\n        ...formControlContext,\n        ...newProps,\n        setRefList,\n        handleChange,\n        handleMultiValueChange,\n        value: pinInputValue,\n      }}\n    >\n      {children && (\n        <HStack flexDirection=\"row\" space={space} {...padding} ref={ref}>\n          {indexSetter(children)}\n        </HStack>\n      )}\n    </PinInputContext.Provider>\n  );\n};\n\nexport default React.memo(React.forwardRef(PinInput));\n"]},"metadata":{},"sourceType":"module"}